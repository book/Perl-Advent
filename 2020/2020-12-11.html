<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
    <meta http-equiv="Content-Language" content="en" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="WWW::AdventCalendar v1.112" />
    <link rel="alternate" title="Perl Advent Calendar 2020 XML feed" href="atom.xml" type="application/atom+xml" />
    <link rel="shortcut icon" href="favicon.ico" />
    <link rel="stylesheet" href="style.css" type="text/css" />
    <link rel="stylesheet" href="2020.css" type="text/css" />
    <title>
Perl Advent Calendar 2020 - 
CPAN::Mini

</title>
</head>
<body>
    <div id="contentwrapper">
        <div id="header">
            <h1><a href="index.html">Perl Advent Calendar 2020</a></h1>
        </div>

        <p id="tagline">2020 twenty four merry days of Perl
         <a class='feed' href="atom.xml">Feed</a>
        </p>

        <div id="content">
          

<h1 class='title'>CPAN::Mini</h1>
<div class='subtitle'>CPAN::Mini - 2020-12-11</div>

<div class='pod'><p><div class="bestof"> 2020 has been time consuming - a global pandemic, giant fires, horrific floods and political unrest - which has left us little time for side projects. This year we're looking back to happier times into the 20+ year archive with the Best of the Perl Advent Calendar. </div>

</p>



<p>As you can probably guess, I like CPAN. I&#39;ve come to rely on the fact that I have thousands of modules at my fingertips that enable me to do a wide range of stuff using other people tools. Which is a bit of a problem when I&#39;m working offline. There&#39;s nothing more frustrating when you&#39;re coding Perl than hacking on a quick script and thinking something like &quot;It&#39;d be nice to use DBD::SQLite to store this data&quot; then discovering it&#39;s not installed, and you&#39;re offline so you can&#39;t download it.</p>

<p>What I actually want is a copy of CPAN on my laptop so that I can always install modules whenever I want. Of course, CPAN is big - several gigabytes - and I don&#39;t really have the patience to download the whole thing using rsync. Rather than the whole thing, I just need the latest version of each module - on the odd occasion I want an older version of a module I can wait till I&#39;m back online.</p>

<p>Enter the <code>minicpan</code> script, part of <b>CPAN::Mini</b>. This script creates (and update) a small - but perfectly usable - local copy of CPAN. I&#39;m never going to be stuck up the proverbial creek without a Perl module to paddle with again.</p>

<p>Creating a mirror of CPAN couldn&#39;t be easier. First you need to install CPAN::Mini with the <code>cpan</code> shell (or use cpanplus if you prefer)</p>

<pre><code>  travis:~ mark$ sudo cpan
  cpan shell -- CPAN exploration and modules installation (v1.76)
  ReadLine support enabled

  cpan&gt; install CPAN::Mini</code></pre>

<p>Then you need to work out which CPAN you&#39;re going to mirror from and where you&#39;re going to store it locally. The former is easy - you can either go to the list of mirrors on cpan.org, or you can just set it to be whatever you set the <code>cpan</code> shell to use:</p>

<pre><code>  bash$ sudo cpan
  cpan shell -- CPAN exploration and modules installation (v1.76)
  ReadLine support enabled&lt;/pre&gt;

  cpan&gt; o conf urllist
          urllist           
          ftp://ftp.demon.co.uk/pub/CPAN/</code></pre>

<p>Where you put your local mirror isn&#39;t really important - anywhere that&#39;s got half a gigabyte of free space will do. I put mine in my webserver&#39;s document root (<code>/Library/WebServer/Documents/CPAN</code>) so it can be accessed from a webbrowser if I need to.</p>

<p>All that&#39;s left for us to do now is run the <code>minicpan</code> command passing the remote server with <code>-r</code> and the local location with <code>-l</code>.</p>

<pre><code>  bash$ minicpan -r ftp://ftp.demon.co.uk/pub/CPAN/ \
                 -l /Library/WebServer/Documents/CPAN</code></pre>

<p>This&#39;ll then chug away for a fair old time downloading the CPAN indexes and every file pointed to in the indices (with the exception of new versions of Perl or Ponie). A few days later when you want to update your mirror you just need to run the same command again:</p>

<pre><code>  bash$ minicpan -r ftp://ftp.demon.co.uk/pub/CPAN/ \
                 -l /Library/WebServer/Documents/CPAN&lt;/pre&gt;</code></pre>

<p>And it&#39;ll redownload these indices, download any new files and delete any files that it&#39;s previously downloaded that aren&#39;t needed anymore. It&#39;ll be much much quicker this time as probably only a few modules will have been released for the first time or updated in that time period.</p>

<h3 id="Using-Your-New-Mirror">Using Your New Mirror</h3>

<p>If you want to quickly configure the cpan shell to use the mirror (if for example you&#39;re offline at the time) then you can tell it to use your mirror for the rest of the session</p>

<pre><code>  bash$ sudo cpan
  cpan shell -- CPAN exploration and modules installation (v1.76)
  ReadLine support enabled&lt;/pre&gt;

  cpan&gt; o conf urllist unshift file:///Library/WebServer/Documents/CPAN/</code></pre>

<p>If you want to always use your mirror (which will be much much quicker but you&#39;ll have to remember to keep it up to date) you can then save that new configuration:</p>

<pre><code>  cpan&gt; o conf commit</code></pre>

<p>And that&#39;s it! You now have a fast copy of CPAN that you can use wherever you are.</p>

</div>

<div id='author'>
<img alt='Gravatar Image' style='vertical-align:middle' src=http://www.gravatar.com/avatar/5d71b5f0c61e97cd452d625cc24a4c82?r=g&s=80&d=retro />
This article contributed by: Mark Fowler &lt;mark@twoshortplanks.com&gt;
</div>


<ul id="pager">
    <li class="previous"><a title="Regexp::Common" href="2020-12-10.html">Previous</a></li>

    <li class="next"><a title="Generate static web sites using your favorite Perl framework" href="2020-12-12.html">Next</a></li>
</ul>
<div style="clear: both"></div>

        </div>

    </div>



</body>
</html>





