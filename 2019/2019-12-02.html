<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
    <meta http-equiv="Content-Language" content="en" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="WWW::AdventCalendar v1.112" />
    <link rel="alternate" title="Perl Advent Calendar 2019 XML feed" href="atom.xml" type="application/atom+xml" />
    <link rel="shortcut icon" href="favicon.ico" />
    <link rel="stylesheet" href="style.css" type="text/css" />
    <link rel="stylesheet" href="2019.css" type="text/css" />
    <title>
Perl Advent Calendar 2019 - 
Have Elf Been Pwned?

</title>
</head>
<body>
    <div id="contentwrapper">
        <div id="header">
            <h1><a href="index.html">Perl Advent Calendar 2019</a></h1>
        </div>

        <p id="tagline">2019 twenty four merry days of Perl
         <a class='feed' href="atom.xml">Feed</a>
        </p>

        <div id="content">
          

<h1 class='title'>Have Elf Been Pwned?</h1>
<div class='subtitle'>WebService::HIBP - 2019-12-02</div>

<div class='pod'><h3 id="Mess-with-the-Best">Mess with the Best...</h3>

<p>Butters Jollycane silently cursed. The piles of presents from yesterday were back. Each of the hackers had, if anything, larger piles of gifts waiting to go out than they&#39;d had the day before - even though they were meant to be on the naughty list.</p>

<p>This could only mean one thing: Somehow that Dade Murphy kid had got back into the system despite Jollycane&#39;s efforts yesterday to make sure everyone was now using sufficiently strong passwords hasn&#39;t been enough.</p>

<p>He checked the logs. Yep, they&#39;d got in using Pepper&#39;s account again.</p>

<h3 id="Get-Hacked-Like-The-Rest">...Get Hacked Like The Rest</h3>

<p>&quot;I don&#39;t understand it&quot;, Pepper explained, &quot;that zxcvbn doohicky you made yesterday said the password was fine&quot;</p>

<p>&quot;Okay, okay...let&#39;s see the new Post-it note.&quot;</p>

<p>&quot;Oh I didn&#39;t write it down this time&quot;, Pepper beamed, &quot;I can remember it! After all it&#39;s one of the passwords I&#39;ve been using for years!&quot;</p>

<p>&quot;Wait, you use the same password on other sites?&quot;</p>

<p>&quot;Oh yes. Very secure it is. I&#39;ve never had a problem with it...I use it for all my accounts&quot;</p>

<p>Jollycane inwardly sighed.</p>

<h3 id="Have-I-Been-Pwned">Have I Been Pwned?</h3>

<p>Credential reuse on websites is a real problem. No matter how secure you make your website, if an elf reuses a username or password that they&#39;ve used on another website and that website gets hacked, it can spell doom and gloom for your security. People who are most definitely on Santa&#39;s naughty list regularly distribute lists of these stolen credentials. All Dade Murphy had to do was download a copy of these lists and see if the same compromised username and password that Pepper had used on Elf Single Mingles would allow him to login to Santa&#39;s workshop using Pepper&#39;s account.</p>

<p>Jollycane quickly pulled up the <a href="https://haveibeenpwned.com/">Have I Been Pwned?</a> website and tapped in Pepper&#39;s account details.</p>

<p><center><img src="hibp.jpg" width="630" height="951" alt="HIBP Website"></center>

</p>



<p>Have I Been Pwned keeps a copy of all of the well known lists of stolen credentials and allows people to check if their credentials have been exposed (if you haven&#39;t done so recently you might want to check out <i>your</i> email address on there right now!) Looking at the screen Jollycane could see numerous places where Pepper&#39;s account had been broken into on other sites.</p>

<h3 id="Password-Reuse-Avoidance">Password Reuse Avoidance?</h3>

<p>Jollycane would send out an all workshop email instructing everyone to not reuse their passwords on any other websites. But how could he enforce that?</p>

<p>Believe it or not, Have I Been Pwned? has an API for that, or rather they have an API that&#39;ll let you work out if a password has been included anywhere in any of the well known published password breaches.</p>

<p>Using the API is slightly more complicated than a normal REST API but <a href="https://metacpan.org/module/WebService::HIBP">WebService::HIBP</a> abstracts away the details:</p>

<table class='code-listing'><tr><td class='line-numbers'><br /><code>1:&nbsp;<br />2:&nbsp;<br />3:&nbsp;<br />4:&nbsp;<br />5:&nbsp;<br />6:&nbsp;<br />7:&nbsp;<br />8:&nbsp;<br />9:&nbsp;<br />10:&nbsp;</code><br />&nbsp;</td><td class='code'><br /><code><span class="keyword">my</span> <span class="symbol">$hibp</span> <span class="operator">=</span> <span class="word">WebService::HIBP</span><span class="operator">-&gt;</span><span class="word">new</span><span class="structure">();</span><br /><span class="keyword">for</span> <span class="keyword">my</span> <span class="symbol">$password</span> <span class="structure">(</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span class="single">'santa'</span><span class="operator">,</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span class="single">'Merry Christmas'</span><span class="operator">,</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span class="single">'All I want For Christmas is Yoooooooooou'</span><span class="operator">,</span><br /><span class="structure">)</span> <span class="structure">{</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span class="word">say</span> <span class="double">&quot;$password was breached &quot;</span><span class="operator">,</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="symbol">$hibp</span><span class="operator">-&gt;</span><span class="word">password</span><span class="structure">(</span> <span class="symbol">$password</span> <span class="structure">)</span><span class="operator">,</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="double">&quot; times&quot;</span><span class="structure">;</span><br /><span class="structure">}</span></code><br />&nbsp;</td></table>

<p>Which shows us just how bad the elves choices are:</p>

<pre><code>    santa was breached 10898 times
    Merry Christmas was breached 7 times
    All I want For Christmas is Yoooooooooou was breached 0 times</code></pre>

<p>But wait, how does it do that without sending HIBP the passwords to check? It obviously doesn&#39;t download the terabytes of exposed data each time it checks.</p>

<p>In a word: Hashing. The module creates a one-way hash of the password and then sends just the first few characters of the hash to HIBP via the API (you wouldn&#39;t want to send the whole hash because that means HIBP could theoretically brute force the password.) HIBP returns a list of hashes of all compromised passwords that hashes also start with those same characters. The module can then check if the hash of the original password is contained in that list, and if it is, then blammo - the password was compromised.</p>

<h3 id="Another-Day">Another Day</h3>

<p>With Website::HIBP Jollycane had plugged another hole. But he was worried. He thought he was done yesterday...but he had a sneaking suspicion that he wasn&#39;t quite done with his battle with these particular brats.</p>

</div>

<div id='author'>
<img alt='Gravatar Image' style='vertical-align:middle' src=http://www.gravatar.com/avatar/5d71b5f0c61e97cd452d625cc24a4c82?r=g&s=80&d=retro />
This article contributed by: Mark Fowler &lt;mark@twoshortplanks.com&gt;
</div>


<ul id="pager">
    <li class="previous"><a title="J1ngle? No...zxcvbn" href="2019-12-01.html">Previous</a></li>

    <li class="next"><a title="Two Factor Elfication" href="2019-12-03.html">Next</a></li>
</ul>
<div style="clear: both"></div>

        </div>

    </div>



</body>
</html>





