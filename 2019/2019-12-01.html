<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
    <meta http-equiv="Content-Language" content="en" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="WWW::AdventCalendar v1.112" />
    <link rel="alternate" title="Perl Advent Calendar 2019 XML feed" href="atom.xml" type="application/atom+xml" />
    <link rel="shortcut icon" href="favicon.ico" />
    <link rel="stylesheet" href="style.css" type="text/css" />
    <link rel="stylesheet" href="2019.css" type="text/css" />
    <title>
Perl Advent Calendar 2019 - 
J1ngle? No...zxcvbn

</title>
</head>
<body>
    <div id="contentwrapper">
        <div id="header">
            <h1><a href="index.html">Perl Advent Calendar 2019</a></h1>
        </div>

        <p id="tagline">2019 twenty four merry days of Perl
         <a class='feed' href="atom.xml">Feed</a>
        </p>

        <div id="content">
          

<h1 class='title'>J1ngle? No...zxcvbn</h1>
<div class='subtitle'>Data::Password::zxcvbn - 2019-12-01</div>

<div class='pod'><h3 id="Zero-Cool-Situation">Zero Cool Situation</h3>

<p>Butters Jollycane stared up in amazement at the towering piles of gifts before him. Never before has he seen such large piles of presents for so few people. There was one pile for &quot;Dade Murphey&quot;, another for &quot;Kate Libby&quot; and another for someone with the dubious name of &quot;Cereal Killer&quot;.</p>

<p>What&#39;s worse, up until a week ago these people had been scheduled for a coal delivery, after a prank they&#39;d been involved in with taking over some automated office lights in a tower block to display dubious messages had got them assigned to the naughty list. So why had Pepper Frostyflakes over in accounting used his login to assign them such lavish gifts at 3am this morning?</p>

<h3 id="Hack-The-Planet">Hack The Planet!</h3>

<p>&quot;I was asleep in my bed at three am this morning!&quot;, Pepper exclaimed, &quot;Do I look like an Elf on the Shelf, up all night long? I need my beauty sleep&quot;.</p>

<p>&quot;And your password is secure?&quot;, Jollycane asked.</p>

<p>&quot;It&#39;s locked away right here, where it always is&quot;, Pepper replied as he unlocked his desk draw and pulled out a dog-eared post-it note. &quot;I wrote it down and locked it away because of the silly password rules you tech Elfs put in place - you know, with the numbers and uppercase and lowercase and weird punctuation you guys always want.&quot;</p>

<p>Pepper flipped over the post it note which had just one word written on it: <code>J1ngle?</code></p>

<p>Jollycane&#39;s jaw dropped. It was obvious that not only had they been hacked by some young miscreants, but they&#39;d done it just by guessing Pepper&#39;s super simple password.</p>

<h3 id="Never-fear-zxcvbn-is-here">Never fear, zxcvbn is here</h3>

<p>Jollycane thought for a minute if he should give Pepper the same lecture he&#39;d given the last six elves that had had their password guessed by mischievous agents. It&#39;s not enough to switch an <code>1</code> for an <code>i</code> or uppercase the first letter. It&#39;s just a simple matter of programming to try those basic transformations too. But Pepper had followed the policy...maybe it was time for a change.</p>

<p>What Jollycane needed was some way to <i>rate</i> the passwords users were using. Luckily, Dropbox has been working on this problem and published their <a href="https://www.usenix.org/conference/usenixsecurity16/technical-sessions/presentation/wheeler">zxcvbn</a> algorithm that can do just that. And there&#39;s a Perl implementation on the CPAN, <a href="https://metacpan.org/module/Data::Password::zxcvbn">Data::Password::zxcvbn</a>.</p>

<table class='code-listing'><tr><td class='line-numbers'><br /><code>1:&nbsp;<br />2:&nbsp;<br />3:&nbsp;<br />4:&nbsp;<br />5:&nbsp;<br />6:&nbsp;<br />7:&nbsp;</code><br />&nbsp;</td><td class='code'><br /><code><span class="comment">#!/usr/bin/perl<br /></span><br /><span class="keyword">use</span> <span class="float">5.024</span><span class="structure">;</span><br /><span class="keyword">use</span> <span class="pragma">warnings</span><span class="structure">;</span><br /><br /><span class="keyword">use</span> <span class="word">Data::Password::zxcvbn</span> <span class="words">qw( password_strength)</span><span class="structure">;</span><br /><span class="keyword">my</span> <span class="symbol">$result</span> <span class="operator">=</span> <span class="word">password_strength</span><span class="structure">(</span><span class="symbol">$ARGV</span><span class="structure">[</span><span class="number">0</span><span class="structure">]);</span></code><br />&nbsp;</td></table>

<p>The result is a hashref that contains a lot of useful information about the strength of the password. At the most basic we have the score:</p>

<table class='code-listing'><tr><td class='line-numbers'><br /><code>1:&nbsp;<br />2:&nbsp;<br />3:&nbsp;<br />4:&nbsp;<br />5:&nbsp;<br />6:&nbsp;<br />7:&nbsp;<br />8:&nbsp;<br />9:&nbsp;<br />10:&nbsp;<br />11:&nbsp;</code><br />&nbsp;</td><td class='code'><br /><code><span class="keyword">my</span> <span class="symbol">@passwords</span> <span class="operator">=</span> <span class="structure">(</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span class="single">'password'</span><span class="operator">,</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span class="single">'p@ssword'</span><span class="operator">,</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span class="single">'J1ngle?'</span><span class="operator">,</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span class="single">'horse staple battery generator'</span><span class="operator">,</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span class="single">'B2aFkgEhZvFstE9'</span><span class="operator">,</span><br /><span class="structure">);</span><br /><span class="keyword">foreach</span> <span class="keyword">my</span> <span class="symbol">$password</span> <span class="structure">(</span><span class="symbol">@passwords</span><span class="structure">)</span> <span class="structure">{</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">my</span> <span class="symbol">$result</span> <span class="operator">=</span> <span class="word">password_strength</span><span class="structure">(</span> <span class="symbol">$password</span> <span class="structure">);</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span class="word">say</span> <span class="double">&quot;$result-&gt;{score} $password&quot;</span><span class="structure">;</span><br /><span class="structure">}</span></code><br />&nbsp;</td></table>

<p>This goes from <code>0</code> (never use) to <code>4</code> (as secure as the algorithm can figure).</p>

<pre><code>    0 password
    0 p@ssword
    1 J1ngle?
    4 horse staple battery generator
    4 B2aFkgEhZvFstE9</code></pre>

<p>What does that mean in a practical sense? Well, since Santa&#39;s workshop hasn&#39;t implemented any rate limiting on their website logins (ooops, they should really do that) the hackers can probably make, say, oh, ten requests a second to try and log in. How long would it take for each of the passwords to be broken?</p>

<table class='code-listing'><tr><td class='line-numbers'><br /><code>1:&nbsp;<br />2:&nbsp;<br />3:&nbsp;<br />4:&nbsp;<br />5:&nbsp;<br />6:&nbsp;<br />7:&nbsp;<br />8:&nbsp;<br />9:&nbsp;</code><br />&nbsp;</td><td class='code'><br /><code><span class="keyword">use</span> <span class="word">Time::Duration</span> <span class="words">qw( duration )</span><span class="structure">;</span><br /><span class="keyword">foreach</span> <span class="keyword">my</span> <span class="symbol">$password</span> <span class="structure">(</span><span class="symbol">@passwords</span><span class="structure">)</span> <span class="structure">{</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">my</span> <span class="symbol">$result</span> <span class="operator">=</span> <span class="word">password_strength</span><span class="structure">(</span> <span class="symbol">$password</span> <span class="structure">);</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">my</span> <span class="symbol">$duration</span> <span class="operator">=</span> <span class="word">duration</span><span class="structure">(</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="symbol">$result</span><span class="operator">-&gt;</span><span class="structure">{</span><span class="word">crack_times_seconds</span><span class="structure">}</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="operator">-&gt;</span><span class="structure">{</span><span class="word">online_no_throttling_10_per_second</span><span class="structure">}</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span class="structure">);</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span class="word">say</span> <span class="double">&quot;$password would be cracked $duration&quot;</span><span class="structure">;</span><br /><span class="structure">}</span></code><br />&nbsp;</td></table>

<p>Which means:</p>

<pre><code>    password would be cracked just now
    p@ssword would be cracked just now
    J1ngle? would be cracked 9 hours and 33 minutes
    horse staple battery generator would be cracked 2475117468353 years and 229 days
    B2aFkgEhZvFstE9 would be cracked 3170979 years and 72 days</code></pre>

<p>Okay, that really brings it home the difference in password security! Jollycane should implement a rule that no password with a score less than four can be used.</p>

<p>But how can he do that? We&#39;ve obviously established that simple rules that users (and hackers!) can easily follow don&#39;t help matters. What users need is some interactive feedback about why the passwords they&#39;re trying to use aren&#39;t secure, and what they should do to improve them. <code>password_strength</code> provides help with that too:</p>

<table class='code-listing'><tr><td class='line-numbers'><br /><code>1:&nbsp;<br />2:&nbsp;<br />3:&nbsp;<br />4:&nbsp;<br />5:&nbsp;<br />6:&nbsp;<br />7:&nbsp;<br />8:&nbsp;<br />9:&nbsp;<br />10:&nbsp;<br />11:&nbsp;<br />12:&nbsp;<br />13:&nbsp;</code><br />&nbsp;</td><td class='code'><br /><code><span class="keyword">foreach</span> <span class="keyword">my</span> <span class="symbol">$password</span> <span class="structure">(</span><span class="symbol">@passwords</span><span class="structure">)</span> <span class="structure">{</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">my</span> <span class="symbol">$result</span> <span class="operator">=</span> <span class="word">password_strength</span><span class="structure">(</span> <span class="symbol">$password</span> <span class="structure">);</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span class="word">next</span> <span class="word">if</span> <span class="symbol">$result</span><span class="operator">-&gt;</span><span class="structure">{</span><span class="word">score</span><span class="structure">}</span> <span class="operator">&gt;</span> <span class="number">3</span><span class="structure">;</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span class="word">say</span> <span class="double">&quot;# $password&quot;</span><span class="structure">;</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">my</span> <span class="symbol">$feedback</span> <span class="operator">=</span> <span class="symbol">$result</span><span class="operator">-&gt;</span><span class="structure">{</span><span class="word">feedback</span><span class="structure">};</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span class="word">say</span> <span class="double">&quot;WARNING: $feedback-&gt;{warning}&quot;</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="word">if</span> <span class="symbol">$feedback</span><span class="operator">-&gt;</span><span class="structure">{</span><span class="word">warning</span><span class="structure">};</span><br />&nbsp;&nbsp;&nbsp;&nbsp;<span class="word">say</span> <span class="double">&quot;* $_&quot;</span> <span class="word">foreach</span> <span class="symbol">$feedback</span><span class="operator">-&gt;</span><span class="structure">{</span><span class="word">suggestions</span><span class="structure">}</span><span class="operator">-&gt;</span><span class="cast">@*</span><span class="structure">;</span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<span class="word">say</span> <span class="double">&quot;&quot;</span><span class="structure">;</span><br /><span class="structure">}</span></code><br />&nbsp;</td></table>

<p>This gives us output we can show the end user:</p>

<pre><code>    # password
    WARNING: This is a top-10 common password
    * Add another word or two. Uncommon words are better.

    # p@ssword
    WARNING: This is similar to a commonly used password
    * Predictable substitutions like &#39;@&#39; instead of &#39;a&#39; don&#39;t help very much
    * Add another word or two. Uncommon words are better.

    # J1ngle?
    * Capitalization doesn&#39;t help very much
    * Predictable substitutions like &#39;@&#39; instead of &#39;a&#39; don&#39;t help very much
    * Add another word or two. Uncommon words are better.</code></pre>

<h3 id="Rollout">Rollout</h3>

<p>Jollycane rolled out the new policy and got all his users to change their passwords. Hopefully that would be enough to keep out those undeserving hooligans....at least until tomorrow....</p>

</div>

<div id='author'>
<img alt='Gravatar Image' style='vertical-align:middle' src=http://www.gravatar.com/avatar/5d71b5f0c61e97cd452d625cc24a4c82?r=g&s=80&d=retro />
This article contributed by: Mark Fowler &lt;mark@twoshortplanks.com&gt;
</div>


<ul id="pager">
    <li class="previous"><a title="Promises, Promises..." href="2010-12-11.html">Previous</a></li>

    <li class="next"><a title="Have Elf Been Pwned?" href="2019-12-02.html">Next</a></li>
</ul>
<div style="clear: both"></div>

        </div>

    </div>



</body>
</html>





